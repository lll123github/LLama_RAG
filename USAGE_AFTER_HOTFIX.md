# 📖 修复后的使用指南

## 🎯 功能概述

"导入到提示词"功能已修复，现在可以正常使用。

## 🚀 使用步骤

### 第1步：刷新浏览器

在浏览器中按下：
- **Windows/Linux**: `Ctrl+F5`
- **Mac**: `Cmd+Shift+R`

这会清除缓存并加载最新的前端代码。

### 第2步：执行搜索

1. 在右侧搜索框中输入关键词
   - 例如: "docker", "python", "kubernetes" 等

2. 点击"搜索"按钮或按 `Enter`

3. 等待搜索结果显示

### 第3步：导入上下文

1. 在搜索结果中找到相关的结果

2. 点击该结果下方的蓝色按钮："导入到提示词"

3. **立即看到**:
   - 聊天框上方出现绿色提示框
   - 显示 "✓ 已导入上下文: ..." 
   - 光标自动聚焦到聊天输入框

### 第4步：发送消息

1. 在聊天框中输入你的问题或消息

2. 按 `Enter` 发送（或 `Shift+Enter` 换行）

3. **Llama 会**:
   - 接收你的消息和导入的上下文
   - 基于上下文和消息进行回复
   - 提供更准确的答案

### 第5步：清除上下文（可选）

如果想清除已导入的上下文：

1. 点击绿色提示框右侧的 "✕" 按钮

2. 绿色提示框消失

3. 后续的消息不会包含该上下文

## 💡 使用示例

### 示例1：查询 Docker 相关问题

```
搜索框: "docker"
↓
点击"搜索"
↓
看到搜索结果
↓
点击"导入到提示词"
↓
绿色提示框出现，显示 Docker 相关内容
↓
聊天框输入: "这个 Docker 命令是什么意思？"
↓
Llama 基于导入的 Docker 文档回答
```

### 示例2：多个上下文的使用

```
搜索1: "kubernetes"
↓
导入上下文 (绿色框显示 k8s 内容)
↓
聊天: "k8s 是什么？"
↓
Llama 回答
↓
搜索2: "docker compose"
↓
导入新上下文 (绿色框更新为 docker-compose 内容)
↓
聊天: "docker-compose 和 kubernetes 的区别？"
↓
Llama 基于新的上下文回答
```

### 示例3：清除和重新导入

```
已导入上下文
↓
点击 "✕" 清除
↓
绿色框消失
↓
搜索新关键词
↓
导入新上下文
↓
继续聊天
```

## 🎨 界面说明

### 搜索面板（右侧）

```
┌─────────────────────────┐
│ 📚 上下文搜索           │
├─────────────────────────┤
│ [搜索框] [搜索按钮]     │
├─────────────────────────┤
│ 搜索结果:               │
│ ┌─────────────────────┐ │
│ │ 📄 文件名.md        │ │
│ │ 搜索结果的上下文... │ │
│ │ [导入到提示词]      │ │
│ └─────────────────────┘ │
│ ┌─────────────────────┐ │
│ │ 📄 另一个文件.md    │ │
│ │ 另一个搜索结果...   │ │
│ │ [导入到提示词]      │ │
│ └─────────────────────┘ │
└─────────────────────────┘
```

### 聊天面板（左侧）

```
┌─────────────────────────────────┐
│ 聊天消息区                      │
│ ┌─────────────────────────────┐ │
│ │ 你好！有什么可以帮助的吗？  │ │
│ └─────────────────────────────┘ │
│ ┌─────────────────────────────┐ │
│ │ 你好！我是 Llama 聊天助手。 │ │
│ └─────────────────────────────┘ │
├─────────────────────────────────┤
│ ✓ 已导入上下文: Docker 是...   ✕ │
├─────────────────────────────────┤
│ [输入消息框]        [发送按钮]  │
└─────────────────────────────────┘
```

## ⚙️ 配置选项

### 搜索框

- **输入**: 输入要搜索的关键词
- **搜索按钮**: 执行搜索
- **快捷键**: `Enter` 键

### 聊天框

- **输入**: 输入要发送的消息
- **发送按钮**: 发送消息
- **快捷键**: 
  - `Enter` - 发送
  - `Shift+Enter` - 换行

### 导入框

- **导入按钮**: 导入搜索结果到聊天框
- **清除按钮**: 清除已导入的上下文
- **显示**: 仅在导入后显示

## 🔧 故障排除

### 问题1：点击导入按钮没有反应

**解决方案**:
1. 按 `Ctrl+F5` 刷新浏览器
2. 检查浏览器控制台（F12）是否有错误
3. 尝试搜索其他关键词

### 问题2：绿色提示框出现但为空

**解决方案**:
1. 确保搜索结果包含有效内容
2. 检查 `rag/content/` 目录是否有文件
3. 尝试搜索其他关键词

### 问题3：导入的上下文没有包含在消息中

**解决方案**:
1. 检查绿色提示框是否仍然显示
2. 确保消息在导入后发送
3. 检查 Llama 服务是否正常运行

### 问题4：浏览器显示错误

**解决方案**:
1. 打开浏览器开发者工具（F12）
2. 查看 Console 标签中的错误信息
3. 检查网络连接
4. 重启服务

## 📊 性能提示

### 优化搜索

- 使用具体的关键词（如 "docker" 而不是 "d"）
- 搜索结果会在 100-500ms 内返回
- 缓存搜索比实时搜索更快

### 优化聊天

- 导入相关的上下文会获得更准确的回答
- 保持消息简洁清晰
- 一次导入一个上下文效果最好

## 🎓 最佳实践

### ✅ 推荐做法

1. **精确搜索**: 使用具体的关键词
2. **相关导入**: 只导入与问题相关的上下文
3. **清晰提问**: 在聊天框中提出清晰的问题
4. **及时清除**: 不需要时清除旧的上下文

### ❌ 避免做法

1. **过度导入**: 不要导入太多无关的上下文
2. **模糊搜索**: 避免使用过于宽泛的关键词
3. **重复导入**: 不要重复导入相同的上下文
4. **忘记清除**: 在导入新上下文前清除旧的

## 📱 移动设备使用

### 手机

- 搜索面板会显示在下方
- 点击"导入"后会自动滚动到聊天框
- 使用虚拟键盘输入

### 平板

- 双面板布局可能需要横屏
- 触摸操作与桌面相同
- 建议使用蓝牙键盘

## 🔐 隐私和安全

- ✅ 所有数据在本地处理
- ✅ 不上传任何数据到云服务
- ✅ 搜索内容仅在本地存储
- ✅ 聊天记录仅保存在浏览器内存

## 📞 获取帮助

### 文档

- `QUICK_START.md` - 快速开始
- `TEST_IMPORT_FEATURE.md` - 测试指南
- `BUG_FIX_NOTES.md` - 修复说明

### 日志

- 浏览器控制台 (F12)
- `/tmp/llama_server.log` - Llama 日志
- `/tmp/flask_app.log` - Flask 日志

## ✨ 新功能亮点

### 修复后的改进

- ✅ 更稳定的事件处理
- ✅ 更好的特殊字符支持
- ✅ 更快的响应速度
- ✅ 更清晰的用户反馈

## 🎉 总结

"导入到提示词"功能现在已完全可用！

1. **刷新浏览器** - 加载最新代码
2. **搜索内容** - 找到相关信息
3. **导入上下文** - 点击导入按钮
4. **发送消息** - 基于上下文聊天
5. **清除上下文** - 点击 ✕ 按钮

---

**修复日期**: 2025-12-13  
**状态**: ✅ 已修复并可用  
**版本**: 1.0.1

